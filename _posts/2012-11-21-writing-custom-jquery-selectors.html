---
layout: post
title: Writing custom jQuery selectors
date: 2012-11-21
comments: false
legacy: true
---

<h1>{{ page.title }}</h1>
<div class='post'>
jQuery supports a lot of <a href="http://api.jquery.com/category/selectors/">DOM element selectors</a> natively. However it does not provide some functionality, for example filtering by CSS values. In these cases you can use the <a href="http://api.jquery.com/filter/">filter method</a> or add a filter to jQuery's selector engine <a href="https://github.com/jquery/sizzle/wiki/Sizzle-Documentation#wiki-filtering">Sizzle</a>.<br /><br />jQuery provides an alias for the Sizzle filter object&nbsp;<code>Sizzle.selectors.filter</code>.&nbsp;Below is the complete code for adding an "rgbColor" filter to this object -&nbsp;&nbsp;<code>$.expr[":"]</code>:<br /><br /><pre class="brush: javascript">&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"&gt;&lt;/script&gt;<br /><br />&lt;div style="color:red"&gt;Hello&lt;/div&gt;<br />&lt;div&gt;world&lt;/div&gt;<br />&lt;div style="color:black"&gt;and&lt;/div&gt;<br />&lt;div style="color:rgb(50,150,0)"&gt;jQuery.&lt;/div&gt;<br /><br />&lt;script&gt;<br />     $.expr[":"].rgbColor = function(element, index, customSelectorParts)<br />     {<br /> var selectorArguments = customSelectorParts[3];<br /> <br /> if (selectorArguments == undefined)<br /> {<br />  var selectorRgb = "0,0,0";<br /> }<br /> else<br /> {<br />  var selectorRgb = selectorArguments.replace(/ /g, "");<br /> }<br /> var elementColor = $(element).css("color");<br /> var elementRgb = elementColor.replace("rgb(","").replace(")","").replace(/ /g, "");<br /> <br />     return elementRgb == selectorRgb;<br />    }<br /><br />    $("div:rgbColor").append(" - matches div:rgbColor -");<br />    $("div:not(:rgbColor)").append(" - matches not(div:rgbColor)-");<br />    $("div:rgbColor(255,0,0)").append( " - matches div:rgbColor(255,0,0) - ");<br />&lt;/script&gt;<br /><br /></pre>Which gives us:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-eQHt9wpRdA8/UKzl4GrA71I/AAAAAAAAAE8/4D0-ULLI2Ek/s1600/custom-jquery-selectors.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-eQHt9wpRdA8/UKzl4GrA71I/AAAAAAAAAE8/4D0-ULLI2Ek/s1600/custom-jquery-selectors.png" /></a></div><div class="separator" style="clear: both; text-align: left;">The filter function needs to return a boolean value indicating whether the element matches the selector.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Filters can accept arguments, for example rgb values in the code above. The third argument to the filter function is an array containing the parsed parts of the selector. For example these are the three values &nbsp;for customSelectorParts:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both;">[":rgbColor", "rgbColor", undefined, undefined, index: 0, input: ":rgbColor"]</div><div class="separator" style="clear: both;">[":rgbColor", "rgbColor", undefined, undefined, index: 0, input: ":rgbColor"]</div><div class="separator" style="clear: both;">[":rgbColor(255,0,0)", "rgbColor", "", "255,0,0", index: 0, input: ":rgbColor(255,0,0)"]&nbsp;</div><br /><div class="separator" style="clear: both; text-align: left;">So the value at customSelectorParts[3] gives us the filter arguments.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">A fourth argument - not included in the example code - gives the list of all elements that the filter is run against. The second argument (index) indicates the position of the currently filtered element in that list.</div><br /></div>
<h2>Comments</h2>
<div class='comments'>
</div>
