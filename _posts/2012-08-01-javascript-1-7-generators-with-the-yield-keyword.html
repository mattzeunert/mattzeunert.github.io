---
layout: post
title: Javascript 1.7- generators with the yield keyword
date: 2012-08-01
comments: false
legacy: true
---

<h1>{{ page.title }}</h1>
<div class='post'>
<p class="feature-support-warning">Javascript 1.7 is specific to Firefox (2.0+). The yield keyword is not part of EcmaScript 5.1. </p> <h3>What are iterators/generators?</h3> <p>An <i>iterator</i> is like a function that returns an array, except that it can return values one by one. That way the function that is calling the iterator can react to the new value before fetching the next one - using the <code>next</code> function. <br>A <i>generator</i> is a function that generates an iterator, typically using the <code>yield</code> keyword. </p> <h3>Generating a prime number iterator</h3> <pre class="brush:javascript"><br />&lt;script type=&quot;text/javascript;version=1.7&quot;&gt;<br />function primeNumbers()<br />{<br /> var nextPotentialPrime = 2;<br /> while (true)<br /> {<br />  document.write(&quot;Checking if &quot; + nextPotentialPrime + &quot; is a prime number.&lt;br&gt;&quot;);<br />  if (isPrime(nextPotentialPrime))<br />  {<br />   yield nextPotentialPrime;<br />  }<br />  nextPotentialPrime++;<br /> }<br />}<br /><br />// Let's get the first 5 prime numbers<br />var primeNumberGenerator = primeNumbers(); // generate the iterator<br />for(var i=0; i&lt;5; i++)<br />{<br /> document.write(primeNumberGenerator.next() + &quot; is a prime number.&lt;br&gt;&quot;)<br />}<br /><br />//Just a helper function, not relevant to Javascript generators<br />function isPrime(num)<br />{<br /> for (var i = 2; i &lt; num; i++)<br />  {<br />  if (num % i == 0)<br />  {<br />   return false;<br />  }<br /> }<br /> return true; <br />}<br />&lt;/script&gt;<br /></pre> Output:   <pre class="brush: html"><br />Checking if 2 is a prime number.<br />2 is a prime number.<br />Checking if 3 is a prime number.<br />3 is a prime number.<br />Checking if 4 is a prime number.<br />Checking if 5 is a prime number.<br />5 is a prime number.<br />Checking if 6 is a prime number.<br />Checking if 7 is a prime number.<br />7 is a prime number.<br />Checking if 8 is a prime number.<br />Checking if 9 is a prime number.<br />Checking if 10 is a prime number.<br />Checking if 11 is a prime number.<br />11 is a prime number.<br /></pre> <p>Make sure to put Javascript 1.7 as the version into the type attribute of the <code>&lt;script&gt;</code> tag and use Firefox. Otherwise you'll get an error: </p><pre class="brush:html"><br />Error: SyntaxError: missing ; before statement<br />yield nextPotentialPrime; <br /></pre><p>This is needed because <code>yield</code> was not a reserved word before Javascript 1.7. </p> <p>You can see that the function for checking if the number is a prime isn't called until we're actually ready to print it. </p> <h3>Terminating iterators and non-terminating iterators</h3> <p>The example above generates a non-terminating iterator. In theory you can always get a prime number bigger than the last one by calling <code>primeNumberGenerator.next</code>. <br>A terminating iterator only works a limited number of times. That means you can also use it in a for .. in loop without creating an infinite loop. If you use <code>next</code> and request more values than available a <code>StopIteration</code> exception will be raised.<br>Here's an example of a terminating iterator: </p> <pre class="brush: javascript"><br />&lt;script type=&quot;text/javascript;version=1.7&quot;&gt;<br />function numbers(count)<br />{<br /> for (var i=0; i&lt;count; i++)<br /> {<br />  yield i;<br /> }<br />}<br />var numberIterator = numbers(10);<br />for (var number in numberIterator)<br />{<br /> document.write(number + &quot; &quot;); <br />}<br />&lt;/script&gt;<br /></pre> Output:  <pre class="brush: html"><br />0 1 2 3 4 5 6 7 8 9 <br /></pre></div>
<h2>Comments</h2>
<div class='comments'>
</div>
